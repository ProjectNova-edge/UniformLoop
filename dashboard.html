<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Account</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <h1>Welcome to Your Dashboard</h1>
  <button onclick="signOutUser()">Logout</button>

  <h2>Your Listings</h2>
  <div id="userListings"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCF35AKe2AHRXaXX_0d3lQi9bpqM_C2NaQ",
      authDomain: "schooluniformsapp.firebaseapp.com",
      projectId: "schooluniformsapp",
      storageBucket: "schooluniformsapp.appspot.com",
      messagingSenderId: "660528209566",
      appId: "1:660528209566:web:5c19e23b57ce2b8039258f"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // Example localStorage mock data. Replace with real backend later.
    const sampleListings = JSON.parse(localStorage.getItem("listings")) || [];

    onAuthStateChanged(auth, (user) => {
      if (user) {
        const userListings = sampleListings.filter(item => item.userId === user.uid);
        const container = document.getElementById("userListings");
        if (userListings.length === 0) {
          container.innerHTML = "<p>No listings yet.</p>";
        } else {
          userListings.forEach(listing => {
            const div = document.createElement("div");
            div.className = "card";
            div.innerHTML = `
              <h3>${listing.item}</h3>
              <p><strong>School:</strong> ${listing.school}</p>
              <p><strong>Size:</strong> ${listing.size}</p>
              <p><strong>Condition:</strong> ${listing.condition}</p>
              <p><strong>Price:</strong> ${listing.price}</p>
              <button>Edit</button> <button>Delete</button>
            `;
            container.appendChild(div);
          });
        }
      } else {
        window.location.href = "index.html"; // redirect if not logged in
      }
    });

    window.signOutUser = function() {
      signOut(auth).then(() => {
        window.location.href = "index.html";
      });
    };
  </script>
</body>
</html>
